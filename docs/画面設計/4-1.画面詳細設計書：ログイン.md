## 4-1. ログイン画面：V000010

### 4.1.1. 概要

システム利用のための初回認証を行う画面である。
 ユーザーはメールアドレスとパスワードを入力し、「ログイン」ボタンを押下することで、ワンタイムパスワード（OTP）認証画面に遷移する。
 認証情報はCognitoを通じて検証され、認証成功後にテナントIDが識別される

### 4.1.2.   画面レイアウト

img

### 4.1.3. 画面項目一覧

#### 4.1.3.1. 画面項目

**凡例：**

- **【種別】** A:リンク／B:ボタン／C:チェックボックス／D:カレンダ／L:ドロップダウンリスト／R:ラジオボタン／S:ラベル／T:テキストボックス／U:テキストエリア／F:ファイル選択／I:画像／O:その他
- **【属性】** D:日付／F:全角／H:半角／M:混在／N:数値

| No   | 画面項目名     | 種別 | I/O  | 必須 | 属性 | 桁数 | API名 | 項目名 | 初期値 | 備考                           |
| ---- | -------------- | ---- | ---- | ---- | ---- | ---- | ----- | ------ | ------ | ------------------------------ |
| 1    | システムロゴ   | I    | -    | -    | -    | -    | -     | -      | -      | -                              |
| 2    | タイトル       | S    | -    | -    | -    | -    | -     | -      | -      | -                              |
| 3    | 案内テキスト   | S    | -    | -    | -    | -    | -     | -      | -      | -                              |
| 4    | メールアドレス | T    | I    | ○    | H    | 255  | -     | -      | -      | 半角英数／メール形式           |
| 5    | パスワード     | T    | I    | ○    | M    | 64   | -     | -      | -      | 入力内容はマスク表示           |
| 6    | ログイン       | B    | -    | -    | -    | -    | -     | -      | -      | 認証API呼出                    |
| 7    | パスワード変更 | A    | -    | -    | -    | -    | -     | -      | -      | パスワード再設定画面遷移リンク |

<p style="text-align: center;"><strong>表 4-1 ログイン画面項目一覧</strong></p>

#### 4.1.4. 画面アクション定義

| No   | イベント名                             | アクションの処理詳細                                       | 遷移先画面名称（ID）          |
| ---- | -------------------------------------- | ---------------------------------------------------------- | ----------------------------- |
| 1    | 「ログイン」クリック                   | 入力内容を認証APIに送信し、成功時にOTP認証画面に遷移する。 | OTP認証画面（V000020）        |
| 2    | 「パスワードをお忘れですか？」クリック | パスワード変更画面に遷移する。                             | パスワード変更画面（V000030） |

<p style="text-align: center;"><strong>表 4-2 ログインアクション定義一覧</strong></p>

#### 4.1.5. バリデーション・エラー処理

（1）入力項目バリデーション

| No   | 画面項目名     | チェック内容                | エラーメッセージ                                  | チェックタイミング |
| ---- | -------------- | --------------------------- | ------------------------------------------------- | ------------------ |
| 1    | メールアドレス | 必須チェック                | 「メールアドレスを入力してください」              | 「ログイン」押下時 |
| 2    | メールアドレス | 桁数チェック（255文字以内） | 「メールアドレスは255文字以内で入力してください」 | 同上               |
| 3    | メールアドレス | 形式チェック                | 「正しいメールアドレスの形式で入力してください」  | 同上               |
| 4    | パスワード     | 必須チェック                | 「パスワードを入力してください」                  | 同上               |
| 5    | パスワード     | 桁数チェック（64文字以内）  | 「パスワードは64文字以内で入力してください」      | 同上               |

<p style="text-align: center;"><strong>表 4-3 入力項目バリデーション一覧</strong></p>

（2）認証エラー処理

| No   | エラー条件                             | エラーメッセージ                                             | 処理内容                                       | 備考                 |
| ---- | -------------------------------------- | ------------------------------------------------------------ | ---------------------------------------------- | -------------------- |
| 1    | 認証失敗（メールまたはパスワード誤り） | 「メールアドレスまたはパスワードが正しくありません」         | ・失敗回数をカウント・パスワード入力欄をクリア | 特定情報を表示しない |
| 2    | 連続ログイン失敗                       | 「ログインに連続で失敗しました。アカウントがロックされました。」 | ・アカウントを一時ロック（xx分）               | ログ記録あり         |
| 3    | アカウントロック中                     | 「アカウントがロックされています。しばらく時間をおいて再試行してください」 | ・ログイン不可                                 | -                    |
| 4    | アカウント無効                         | 「このアカウントは無効です。管理者にお問い合わせください」   | ・ログイン不可                                 | -                    |
| 5    | システムエラー                         | 「システムエラーが発生しました。しばらく時間をおいて再試行してください」 | ・ログ記録、詳細は非表示                       | -                    |

（3）エラー表示仕様

エラーメッセージは画面上部（タイトルと入力フォームの間）に表示する。 各エラーパターンの表示例を以下に示す。

[図3-X] エラー表示パターン一覧

- **表示位置**：画面上部（タイトルと入力フォームの間）
- **表示形式**：赤枠または赤背景のメッセージボックス
- **複数エラー**：複数発生時はリスト形式で全て表示
- **クリア条件**：「ログイン」押下または入力修正時

### 4.1.6. セキュリティ要件

- 通信はすべて **HTTPS（TLS1.2以上）** を使用する。
- パスワードは入力時にマスク表示され、オートコンプリート対象外とする。
- ログイン時の認証API呼出は POST メソッドを使用し、暗号化されたチャネルで送信する。
- 認証失敗時のメッセージは汎用的にし、正否判定の特定（メールかパスワードか）を避ける。
- 連続失敗時にはアカウントを一時ロックし、ログ監査に記録する。
- 認証成功時にサーバー側で **tenant_id** を安全に取得し、Contextへ格納する。
- `tenant_id` の保持はブラウザメモリ（Context/State）内のみで、LocalStorageには保存しない。
- セッションタイムアウトはサーバー側設定（例：15分）で管理し、タイムアウト時は再ログインを要求する。

### 4.1.7. 表示制御（ComponentLabelMaster対応）

本画面はシステム共通UIであり、
 `ComponentLabelMaster` による **ラベル可変／表示制御の対象外** とする。

- タイトル「ログイン」および案内文は全テナント共通で固定文言を使用する。
- メールアドレス・パスワード・ログインボタンの構成は全テナント共通。
- ラベル文言、入力制御、必須設定の変更は不可。
- 認証成功後、取得した `tenant_id` に基づいて後続画面（入力画面・出力画面など）で `ComponentLabelMaster` が反映される。
